app.controller('NewRecipeCtrl', ['$scope', '$http', 'Upload', function($scope, $http, Upload){

  var url = "<%= ENV['URL'] %>" || "http://localhost:3000/";

  $scope.post = {};
  $scope.image = {};
  $scope.form = {};

  $scope.form.create = function(){
    var data = {
      'post[title]': $scope.post.title,
      'post[content]': $scope.post.content,
      'post[category]': $scope.post.category
    };

    // ngFileUpload's method to upload a file
    Upload.upload({
      url: url + 'posts',
      fields: data,
      file: $scope.image.file,
      fileFormDataName: 'post[image]'
    }).success(function(response) {
        console.log(response);
    });;
  };
}]);